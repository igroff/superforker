# vim: ft=sh
#make sure we have node going, this needs to be here to make
#the cron tab auto restart work
export ROOT=${ROOT:-"${HOME}/.superforker"}
echo ${ROOT}
if [ ! -d "${ROOT}" ]; then
    mkdir -p "${ROOT}"
fi

#use the node we insist on
export NVM_DIR=""
cp "${SUPERFORKER_ROOT}/lib/nvm.sh" "${ROOT}/nvm.sh"
source "${ROOT}/nvm.sh"
export NEEDED_NODE_VERSION='v0.10.3'
HAS_NEEDED_VERSION=`nvm ls | grep ${NEEDED_NODE_VERSION}`

if [ -z "${HAS_NEEDED_VERSION}" ]; then
  echo 'get the right version of node going'
  nvm install $NEEDED_NODE_VERSION
  npm update
fi
nvm use $NEEDED_NODE_VERSION
